package controle;import Model.Corretor;import Model.CorretorContratado;import Model.CorretorComissionado;import java.io.*;import java.util.*;import javax.swing.*;import limite.*;public class ControleCorretor {    public ControlePrincipal ctrPrincipal;    public LimiteCorretor lmtCorretor;//variavel de instancia responsavel pelo limite dos corretores    private ArrayList<Corretor> listaCorretor = new ArrayList<Corretor>();//array para Corretor    //construtor    public ControleCorretor(ControlePrincipal ctrPrincipal) {        this.ctrPrincipal = ctrPrincipal;        lmtCorretor = new LimiteCorretor(this);        //new LimiteCorretor(this);        try {            this.desserializaCorretor();        } catch (Exception e) {            JOptionPane.showMessageDialog(null, e.getMessage(), "Erro ao abrir arquivo", JOptionPane.ERROR_MESSAGE);        }    }    //metodo para inserir corretor contratado    public void insereContratado(String pNome, int pCreci, double pSalario, Calendar pDate) throws Exception {        //cria um obejto do modelo CorretorContratado e aciona o seu construtor        CorretorContratado contratado = new CorretorContratado(pNome, pCreci, pSalario, pDate);//cria objeto contratado        listaCorretor.add(contratado);//adiciona o contratado no array list de corretor        //grava em arquivo o corretor inserido        this.serializaCorretor();    }      //metodo para inserir vendedor contratado    public void insereComissionado(String pNome, int pCreci, double pComissao) throws Exception {        //chama um obejto do modelo CorretorComissionado e aciona o seu construtor        CorretorComissionado comissionado = new CorretorComissionado(pNome, pCreci, pComissao);//cria objeto contratado        System.out.println(comissionado);        listaCorretor.add(comissionado);//adiciona o contratado no array list de corretor        //grava no arquivo        this.serializaCorretor();    }              public void editaCorretor(int index, Corretor i) {        listaCorretor.remove(index);        listaCorretor.add(index, i);        //Grava edição em arquivo        try {            JOptionPane.showMessageDialog(null, "Corretor editado com sucesso!!!");//mensagem de confirmação            this.serializaCorretor();        } catch (Exception e) {            JOptionPane.showMessageDialog(null, e.getMessage(), "Erro ao gravar arquivo", JOptionPane.ERROR_MESSAGE);        }    }    public void excluiCorretor(int index) throws Exception {        if ((index >= 0) && (getListaCorretor().size() > 0)) {            //remove elemento da lista, através do indice passado pelo LimiteListaCorretor.java            getListaCorretor().remove(index);            //grava remoção no arquivo            this.serializaCorretor();        }        else {            throw new Exception("Operação inválida!!!\nVerifique se foi selecionado algum corretor!!!");        }    }    //metodo para listar os corretoes    public ArrayList<String> listaCorretor() {        ArrayList<String> lista = new ArrayList<String>();        String aux;        for (Corretor i : listaCorretor) {            //verifica se o corretor é comissionado            if (i instanceof CorretorComissionado) {                //retorna informações do corretor comissionado                CorretorComissionado auxComissionado = (CorretorComissionado) i;                aux = "CRECI: " + auxComissionado.getaCreci() + "\nNome: " + auxComissionado.getaNome()                        + "\nComissão: " + auxComissionado.getaComissao();            } else {                //retorna informações do corretor contradado                CorretorContratado auxContratado = (CorretorContratado) i;                int mes = auxContratado.getaDataAdmissao().get(Calendar.MONTH) + 1;                aux = "CRECI: " + auxContratado.getaCreci() + "\nNome: " + auxContratado.getaNome()                        + "\nData Admissão: " + auxContratado.getaDataAdmissao().get(Calendar.DAY_OF_MONTH)                        + "/" + mes + "/"                        + auxContratado.getaDataAdmissao().get(Calendar.YEAR)                        + "\nSalário: " + auxContratado.getaSalarioFixo();            }            System.out.println(aux);            lista.add(aux);        }        return lista;    }    public ArrayList<Corretor> getLista() {        return listaCorretor;    }    //GETTERS E SETTERS    public ArrayList<Corretor> getListaCorretor() {        return listaCorretor;    }    public void setListaCorretor(ArrayList<Corretor> listaCorretor) {        this.listaCorretor = listaCorretor;    }    //metodo para serializa a o corretor, para salvar em arquivo    private void serializaCorretor() throws Exception {        //Stream de gravação        FileOutputStream objFileOS = new FileOutputStream("corretores.dat");        //Stream de gravação        ObjectOutputStream objOS = new ObjectOutputStream(objFileOS);        //grava o vetor no arquivo        objOS.writeObject(listaCorretor);        //limpa objOS        objOS.flush();        //fecha stream        objOS.close();    }    //metodo para desserializar o arquivo de corretores    private void desserializaCorretor() throws Exception {        //nome do arquivo que será lido        File objFile = new File("corretores.dat");        //se o arquivo existir        if (objFile.exists()) {            //objeto de stream de bytes            FileInputStream objFileIS = new FileInputStream("corretores.dat");            //objeto de stream de bytes            ObjectInputStream objIS = new ObjectInputStream(objFileIS);            //converte o objeto lido do arquivo para o tipo ArrayList e atribui ao Array listaCorretor            listaCorretor = (ArrayList<Corretor>) objIS.readObject();            //fecha stream            objIS.close();        }    }}